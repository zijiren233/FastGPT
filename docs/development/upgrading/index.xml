<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>版本更新/升级操作 on FastGPT</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/</link><description>Recent content in 版本更新/升级操作 on FastGPT</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><atom:link href="https://doc.tryfastgpt.ai/docs/development/upgrading/index.xml" rel="self" type="application/rss+xml"/><item><title>升级说明</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/intro/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/intro/</guid><description>FastGPT 升级包括两个步骤：
镜像升级 执行升级初始化脚本 镜像名 linkgit版
FastGPT 主镜像：ghcr.io/labring/fastgpt:latest 商业版镜像：ghcr.io/c121914yu/fastgpt-pro:latest Admin 镜像：ghcr.io/c121914yu/fastgpt-admin:latest 阿里云
FastGPT 主镜像: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt 商业版镜像：ghcr:registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt-pro Admin 镜像: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt-admin 镜像由镜像名和Tag组成，例如: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.6.1 代表4.6.3版本镜像，具体可以看 docker hub, github 仓库。
Sealos 修改镜像 link 打开 Sealos Cloud， 找到桌面上的应用管理 选择对应的应用 - 点击右边三个点 - 变更 修改镜像 - 确认变更
如果要修改配置文件，可以拉到下面的配置文件进行修改。
Docker-Compose 修改镜像 link直接修改yml文件中的image: 即可。随后执行:
docker-compose pull docker-compose up -d 执行升级初始化脚本 link镜像更新完后，可以查看文档中的版本介绍，通常需要执行升级脚本的版本都会标明包含升级脚本，打开对应的文档，参考说明执行升级脚本即可，大部分时候都是需要发送一个POST请求。
QA link为什么需要执行升级脚本 link数据表出现大幅度变更，无法通过设置默认值，或复杂度较高时，会通过升级脚本来更新部分数据表字段。 严格按初始化步骤进行操作，不会造成旧数据丢失。但在初始化过程中，如果数据量大，需要初始化的时间较长，这段时间可能会造成服务无法正常使用。
{{host}} 是什么 link{{}} 代表变量， {{host}}代表一个名为 host 的变量。指的是你服务器的域名或 IP。
Sealos 中，你可以在下图中找到你的域名：
如何获取 rootkey link从docker-compose.yml中的environment中获取，对应的是ROOT_KEY的值。</description></item><item><title>V4.9.5（进行中）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/495/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/495/</guid><description>🚀 新增内容 link 团队成员权限细分，可分别控制是否可创建在根目录应用/知识库以及 API Key ⚙️ 优化 link🐛 修复 link password 检测规则错误</description></item><item><title>V4.9.4</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/494/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/494/</guid><description>升级指南 link1. 做好数据备份 link2. 安装 Redis link docker 部署的用户，参考最新的 docker-compose.yml 文件增加 Redis 配置。增加一个 redis 容器，并配置fastgpt,fastgpt-pro的环境变量，增加 REDIS_URL 环境变量。 Sealos 部署的用户，在数据库里新建一个redis数据库，并复制内网地址的 connection 作为 redis 的链接串。然后配置fastgpt,fastgpt-pro的环境变量，增加 REDIS_URL 环境变量。 3. 更新镜像 tag link 更新 FastGPT 镜像 tag: v4.9.4 更新 FastGPT 商业版镜像 tag: v4.9.4 Sandbox 无需更新 AIProxy 无需更新 4. 执行升级脚本 link该脚本仅需商业版用户执行。
从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv494&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 脚本功能</description></item><item><title>V4.9.3</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/493/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/493/</guid><description>更新指南 link1. 做好数据库备份 link2. 更新镜像 link 更新 FastGPT 镜像 tag: v4.9.3 更新 FastGPT 商业版镜像 tag: v4.9.3 Sandbox 镜像tag: v4.9.3 AIProxy 镜像tag: v0.1.5 🚀 新增内容 link 工作流 debug 模式支持交互节点。 代码运行支持 Python3 代码。 🐛 修复 link 工作流格式转化异常。</description></item><item><title>V4.9.2</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/492/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/492/</guid><description>更新指南 link可直接升级v4.9.3，v4.9.2存在一个工作流数据类型转化错误。
1. 做好数据库备份 link2. SSO 迁移 link使用了 SSO 或成员同步的商业版用户，并且是对接钉钉、企微的，需要迁移已有的 SSO 相关配置:
参考：SSO &amp;amp; 外部成员同步中的配置进行sso-service的部署和配置。
先将原商业版后台中的相关配置项复制备份出来（以企微为例，将 AppId, Secret 等复制出来）再进行镜像升级。 参考上述文档，部署 SSO 服务，配置相关的环境变量 如果原先使用企微组织架构同步的用户，升级完镜像后，需要在商业版后台切换团队模式为“同步模式” 3. 配置参数变更 link修改config.json文件中systemEnv.pgHNSWEfSearch参数名，改成hnswEfSearch。
商业版用户升级镜像后，直接在后台系统配置-基础配置中进行变更。
4. 更新镜像 link 更新 FastGPT 镜像 tag: v4.9.2 更新 FastGPT 商业版镜像 tag: v4.9.2 Sandbox 镜像，可以不更新 AIProxy 镜像修改为: registry.cn-hangzhou.aliyuncs.com/labring/aiproxy:v0.1.4 重要更新 link 知识库导入数据 API 变更，增加chunkSettingMode,chunkSplitMode,indexSize可选参数，具体可参考 知识库导入数据 API 文档。 🚀 新增内容 link 知识库分块优化：支持单独配置分块大小和索引大小，允许进行超大分块，以更大的输入 Tokens 换取完整分块。 知识库分块增加自定义分隔符预设值，同时支持自定义换行符分割。 外部变量改名：自定义变量。 并且支持在测试时调试，在分享链接中，该变量直接隐藏。 集合同步时，支持同步修改标题。 团队成员管理重构，抽离主流 IM SSO（企微、飞书、钉钉），并支持通过自定义 SSO 接入 FastGPT。同时完善与外部系统的成员同步。 支持 oceanbase 向量数据库。填写环境变量OCEANBASE_URL即可。 基于 mistral-ocr 的 PDF 解析示例。 基于 miner-u 的 PDF 解析示例。 ⚙️ 优化 link 导出对话日志时，支持导出成员名。 邀请链接交互。 无 SSL 证书时复制失败，会提示弹窗用于手动复制。 FastGPT 未内置 ai proxy 渠道时，也能正常展示其名称。 升级 nextjs 版本至 14.</description></item><item><title>V4.9.1</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/491/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/491/</guid><description>更新指南 link1. 做好数据库备份 link2. 更新镜像 link 更新 FastGPT 镜像 tag: v4.9.1-fix2 更新 FastGPT 商业版镜像 tag: v4.9.1-fix2 Sandbox 镜像，可以不更新 AIProxy 镜像修改为: registry.cn-hangzhou.aliyuncs.com/labring/aiproxy:v0.1.3 3. 执行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv491&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 脚本功能
重新使用最新的 jieba 分词库进行分词处理。时间较长，可以从日志里查看进度。
🚀 新增内容 link 商业版支持单团队模式，更好的管理内部成员。 知识库分块阅读器。 API 知识库支持 PDF 增强解析。 邀请团队成员，改为邀请链接模式。 支持混合检索权重设置。 支持重排模型选择和权重设置，同时调整了知识库搜索权重计算方式，改成 搜索权重 + 重排权重，而不是向量检索权重+全文检索权重+重排权重。会对检索结果有一定影响，可以通过调整相关权重来进行数据适配。 ⚙️ 优化 link 知识库数据输入框交互 应用拉取绑定知识库数据交由后端处理。 增加依赖包安全版本检测，并升级部分依赖包。 模型测试代码。 优化思考过程解析逻辑：只要配置了模型支持思考，均会解析 标签，不会因为对话时，关闭思考而不解析。 载入最新 jieba 分词库，增强全文检索分词效果。 🐛 修复 link 最大响应 tokens 提示显示错误的问题。 HTTP Node 中，字符串包含换行符时，会解析失败。 知识库问题优化中，未传递历史记录。 错误提示翻译缺失。 内容提取节点，array 类型 schema 错误。 模型渠道测试时，实际未指定渠道测试。 新增自定义模型时，会把默认模型字段也保存，导致默认模型误判。 修复 promp 模式工具调用，未判空思考链，导致 UI 错误展示。 编辑应用信息导致头像丢失。 分享链接标题会被刷新掉。 计算 parentPath 时，存在鉴权失败清空。</description></item><item><title>V4.9.0(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/490/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/490/</guid><description>更新指南 link1. 做好数据库备份 link2. 更新镜像和 PG 容器 link 更新 FastGPT 镜像 tag: v4.9.0 更新 FastGPT 商业版镜像 tag: v4.9.0 Sandbox 镜像，可以不更新 更新 PG 容器为 v0.8.0-pg15, 可以查看最新的 yml 3. 替换 OneAPI（可选） link如果需要使用 AI Proxy 替换 OneAPI 的用户可执行该步骤。
1. 修改 yml 文件 link参考最新的 yml 文件。里面已移除 OneAPI 并添加了 AIProxy配置。包含一个服务和一个 PgSQL 数据库。将 aiproxy 的配置追加到 OneAPI 的配置后面（先不要删除 OneAPI，有一个初始化会自动同步 OneAPI 的配置）
AI Proxy Yml 配置 # AI Proxy aiproxy: image: &amp;#39;ghcr.io/labring/aiproxy:latest&amp;#39; container_name: aiproxy restart: unless-stopped depends_on: aiproxy_pg: condition: service_healthy networks: - fastgpt environment: # 对应 fastgpt 里的AIPROXY_API_TOKEN - ADMIN_KEY=aiproxy # 错误日志详情保存时间（小时） - LOG_DETAIL_STORAGE_HOURS=1 # 数据库连接地址 - SQL_DSN=postgres://postgres:aiproxy@aiproxy_pg:5432/aiproxy # 最大重试次数 - RETRY_TIMES=3 # 不需要计费 - BILLING_ENABLED=false # 不需要严格检测模型 - DISABLE_MODEL_CONFIG=true healthcheck: test: [&amp;#39;CMD&amp;#39;, &amp;#39;curl&amp;#39;, &amp;#39;-f&amp;#39;, &amp;#39;http://localhost:3000/api/status&amp;#39;] interval: 5s timeout: 5s retries: 10 aiproxy_pg: image: pgvector/pgvector:0.</description></item><item><title>V4.8.23</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4823/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4823/</guid><description>更新指南 link1. 做好数据库备份 link2. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.23-fix 更新 fastgpt-pro 商业版镜像 tag: v4.8.23-fix Sandbox 镜像无需更新 3. 运行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4823&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 脚本会清理一些知识库脏数据，主要是多余的全文索引。
🚀 新增内容 link 增加默认“知识库文本理解模型”配置 AI proxy V1版，可替换 OneAPI使用，同时提供完整模型调用日志，便于排查问题。 增加工单入口支持。 ⚙️ 优化 link 模型配置表单，增加必填项校验。 集合列表数据统计方式，提高大数据量统计性能。 优化数学公式，转义 Latex 格式成 Markdown 格式。 解析文档图片，图片太大时，自动忽略。 时间选择器，当天开始时间自动设0，结束设置设 23:59:59，避免 UI 与实际逻辑偏差。 升级 mongoose 库版本依赖。 🐛 修复 link 标签过滤时，子文件夹未成功过滤。 暂时移除 md 阅读优化，避免链接分割错误。 离开团队时，未刷新成员列表。 PPTX 编码错误，导致解析失败。 删除知识库单条数据时，全文索引未跟随删除。 修复 Mongo Dataset text 索引在查询数据时未生效。</description></item><item><title>V4.8.22(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4822/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4822/</guid><description>🌟更新指南 link1. 做好数据库备份 link2. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.22 更新 fastgpt-pro 商业版镜像 tag: v4.8.22 Sandbox 镜像无需更新 3. 运行升级脚本 link仅商业版，并提供 Saas 服务的用户需要运行该升级脚本。
从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4822&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会迁移联系方式到对应用户表中。
🚀 新增内容 link AI 对话节点解析 &amp;lt;think&amp;gt;&amp;lt;/think&amp;gt; 标签内容作为思考链，便于各类模型进行思考链输出。需主动开启模型输出思考。 对话 API 优化，无论是否传递 chatId，都会保存对话日志。未传递 chatId，则随机生成一个 chatId 来进行存储。 ppio 模型提供商 ⚙️ 优化 link 模型未配置时提示，减少冲突提示。 使用记录代码。 内容提取节点，字段描述过长时换行。同时修改其输出名用 key，而不是 description。 团队管理交互。 对话接口，非流响应，增加报错字段。 🐛 修复 link 思考内容未进入到输出 Tokens.</description></item><item><title>V4.8.21</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4821/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4821/</guid><description>更新指南 link1. 做好数据库备份 link2. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.21-fix 更新 fastgpt-pro 商业版镜像 tag: v4.8.21-fix Sandbox 镜像无需更新 完整更新内容 link 新增 - 弃用/已删除的插件提示。 新增 - 对话日志按来源分类、标题检索、导出功能。 新增 - 全局变量支持拖拽排序。 新增 - LLM 模型支持 top_p, response_format, json_schema 参数。 新增 - Doubao1.5 模型预设。阿里 embedding3 预设。 新增 - 向量模型支持归一化配置，以便适配未归一化的向量模型，例如 Doubao 的 embedding 模型。 新增 - AI 对话节点，支持输出思考过程结果，可用于其他节点引用。 优化 - 网站嵌入式聊天窗口，增加窗口位置适配。 优化 - 模型未配置时错误提示。 优化 - 适配非 Stream 模式思考输出。 优化 - 增加 TTS voice 未配置时的空指针保护。 优化 - Markdown 链接解析分割规则，改成严格匹配模式，牺牲兼容多种情况，减少误解析。 优化 - 减少未登录用户的数据获取范围，提高系统隐私性。 修复 - 简易模式，切换到其他非视觉模型时候，会强制关闭图片识别。 修复 - o1,o3 模型，在测试时候字段映射未生效导致报错。 修复 - 公众号对话空指针异常。 修复 - 多个音频/视频文件展示异常。 修复 - 分享链接鉴权报错后无限循环。</description></item><item><title>V4.8.20(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4820/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4820/</guid><description>更新指南 link1. 做好数据库备份 link2. 更新环境变量 link如果有很早版本用户，配置了ONEAPI_URL的，需要统一改成OPENAI_BASE_URL
3. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.20-fix2 更新 fastgpt-pro 商业版镜像 tag: v4.8.20-fix2 Sandbox 镜像无需更新 4. 运行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4820&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 脚本会自动把原配置文件的模型加载到新版模型配置中。
完整更新内容 link 新增 - 可视化模型参数配置，取代原配置文件配置模型。预设超过 100 个模型配置。同时支持所有类型模型的一键测试。（预计下个版本会完全支持在页面上配置渠道）。点击查看模型配置方案 新增 - DeepSeek resoner 模型支持输出思考过程。 新增 - 使用记录导出和仪表盘。 新增 - markdown 语法扩展，支持音视频（代码块 audio 和 video）。 新增 - 调整 max_tokens 计算逻辑。优先保证 max_tokens 为配置值，如超出最大上下文，则减少历史记录。例如：如果申请 8000 的 max_tokens，则上下文长度会减少 8000。 优化 - 问题优化增加上下文过滤，避免超出上下文。 优化 - 页面组件抽离，减少页面组件路由。 优化 - 全文检索，忽略大小写。 优化 - 问答生成和增强索引改成流输出，避免部分模型超时。 优化 - 自动给 assistant 空 content，补充 null，同时合并连续的 text assistant，避免部分模型抛错。 优化 - 调整图片 Host， 取消上传时补充 FE_DOMAIN，改成发送对话前补充，避免替换域名后原图片无法正常使用。 修复 - 部分场景成员列表无法触底加载。 修复 - 工作流递归执行，部分条件下无法正常运行。</description></item><item><title>V4.8.19(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4819/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4819/</guid><description>更新指南 link1. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.19-beta 更新 fastgpt-pro 商业版镜像 tag: v4.8.19-beta Sandbox 镜像无需更新 2. 运行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4819&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 迁移用户表的头像到成员表中。
完整更新内容 link 新增 - 工作流知识库检索支持按知识库权限进行过滤。 新增 - 飞书/语雀知识库查看原文。 新增 - 流程等待插件，可以等待 n 毫秒后继续执行流程。 新增 - 飞书机器人接入，支持配置私有化飞书地址。 优化 - 成员列表分页加载。 优化 - 统一分页加载代码。 优化 - 对话页面加载时，可配置是否为独立页面。 优化 - 成员头像迁移，移动到成员表。 修复 - 语雀文件库导入时，嵌套文件内容无法展开的问题。 修复 - 工作流编排中，LLM 参数无法关闭问题。 修复 - 工作流编排中，代码运行节点还原模板问题。 修复 - HTTP 接口适配对象字符串解析。 修复 - 通过 API 上传文件（localFile）接口，图片过期标记未清除。 修复 - 工作流导入编排时，number input 类型无法覆盖。 修复 - 部分模型提供商 logo 无法正常显示。</description></item><item><title>V4.8.18(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4818/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4818/</guid><description>更新指南 link1. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.18-fix 更新 fastgpt-pro 商业版镜像 tag: v4.8.18-fix Sandbox 镜像无需更新 2. 运行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4818&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会迁移全文检索表，时间较长，迁移期间全文检索会失效，日志中会打印已经迁移的数据长度。
完整更新内容 link 新增 - 支持通过 JSON 配置直接创建应用。 新增 - 支持通过 CURL 脚本快速创建 HTTP 插件。 新增 - 商业版支持部门架构权限模式。 新增 - 支持配置自定跨域安全策略，默认全开。 新增 - 补充私有部署，模型问题排查文档。 优化 - HTTP Body 增加特殊处理，解决字符串变量带换行时无法解析问题。 优化 - 分享链接随机生成用户头像。 优化 - 图片上传安全校验。并增加头像图片唯一存储，确保不会累计存储。 优化 - Mongo 全文索引表分离。 优化 - 知识库检索查询语句合并，同时减少查库数量。 优化 - 文件编码检测，减少 CSV 文件乱码概率。 优化 - 异步读取文件内容，减少进程阻塞。 优化 - 文件阅读，HTML 直接下载，不允许在线阅读。 修复 - HTML 文件上传，base64 图片无法自动转图片链接。 修复 - 插件计费错误。</description></item><item><title>V4.8.17(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4817/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4817/</guid><description>更新指南 link1. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.17-fix-title 更新 fastgpt-pro 商业版镜像 tag: v4.8.17 Sandbox 镜像无需更新 2. 运行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4817&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会将用户绑定的 OpenAI 账号移动到团队中。
调整 completions 接口返回值 link/api/v1/chat/completions 接口返回值调整，对话节点、工具节点等使用到模型的节点，将不再返回 tokens 字段，改为返回 inputTokens 和 outputTokens 字段，分别表示输入和输出的 Token 数量。
完整更新内容 link 新增 - 简易模式工具调用支持数组类型插件。 新增 - 工作流增加异常离开自动保存，避免工作流丢失。 新增 - LLM 模型参数支持关闭 max_tokens 和 temperature。 新增 - 商业版支持后台配置模板市场。 新增 - 商业版支持后台配置自定义工作流变量，用于与业务系统鉴权打通。 新增 - 搜索测试接口支持问题优化。 新增 - 工作流中 Input Token 和 Output Token 分开记录展示。并修复部分请求未记录输出 Token 计费问题。 优化 - Markdown 大小测试，超出 20 万字符不使用 Markdown 组件，避免崩溃。 优化 - 知识库搜索参数，滑动条支持输入模式，可以更精准的控制。 优化 - 可用模型展示UI。 优化 - Mongo 查询语句，增加 virtual 字段。 修复 - 文件返回接口缺少 Content-Length 头，导致通过非同源文件上传时，阿里 vision 模型无法识别图片。 修复 - 去除判断器两端字符串隐藏换行符，避免判断器失效。 修复 - 变量更新节点，手动输入更新内容时候，非字符串类型数据类型无法自动转化。 修复 - 豆包模型无法工具调用。</description></item><item><title>V4.8.16(更新配置文件)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4816/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4816/</guid><description>更新指南 link1. 更新镜像： link 更新 fastgpt 镜像 tag: v4.8.16 更新 fastgpt-pro 商业版镜像 tag: v4.8.16 Sandbox 镜像 tag: v4.8.16 2. 更新配置文件 link参考最新的配置文件，更新 config.json 或 admin 中模型文件配置。给 LLMModel 和 VectorModel 增加 provider 字段，以便进行模型分类。例如：
{ &amp;#34;provider&amp;#34;: &amp;#34;OpenAI&amp;#34;, // 这是新增的 &amp;#34;model&amp;#34;: &amp;#34;gpt-4o&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;gpt-4o&amp;#34;, &amp;#34;maxContext&amp;#34;: 125000, &amp;#34;maxResponse&amp;#34;: 4000, &amp;#34;quoteMaxToken&amp;#34;: 120000, &amp;#34;maxTemperature&amp;#34;: 1.2, &amp;#34;charsPointsPrice&amp;#34;: 0, &amp;#34;censor&amp;#34;: false, &amp;#34;vision&amp;#34;: true, &amp;#34;datasetProcess&amp;#34;: true, &amp;#34;usedInClassify&amp;#34;: true, &amp;#34;usedInExtractFields&amp;#34;: true, &amp;#34;usedInToolCall&amp;#34;: true, &amp;#34;usedInQueryExtension&amp;#34;: true, &amp;#34;toolChoice&amp;#34;: true, &amp;#34;functionCall&amp;#34;: false, &amp;#34;customCQPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;customExtractPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;defaultSystemChatPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;defaultConfig&amp;#34;: {}, &amp;#34;fieldMap&amp;#34;: {} } 完整更新内容 link 新增 - SearXNG 搜索插件点击查看教程 新增 - 商业版支持 API 知识库和链接集合定时同步。 新增 - 猜你想问支持选择模型和自定义提示词。 新增 - 钉钉和企微机器人 webhook 插件。 新增 - 商业版支持钉钉 SSO 登录配置。点击查看教程 新增 - 商业版支持飞书和语雀知识库导入。点击查看教程 新增 - sandbox 新增 createHmac 加密全局方法。 新增 - 工作流右键支持全部折叠。 优化 - 模型选择器。 优化 - SSR 渲染，预判断是移动端还是 pc 端，减少页面抖动。 优化 - 工作流/简易模式变量初始化代码，去除监听初始化，避免因渲染顺序不一致导致的失败。 优化 - 工作流获取数据类型不一致数据时，增加类型转化，避免 undefined。 修复 - 无法自动切换默认语言。增加分享链接，强制执行一次切换默认语言。 修复 - 数组选择器自动兼容 4.</description></item><item><title>V4.8.15(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4815/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4815/</guid><description>新功能预览 linkAPI 知识库 link HTML 渲染 link 源码模式 预览模式 全屏模式 升级指南 link 更新 fastgpt 镜像 tag: v4.8.15-fix3 更新 fastgpt-pro 商业版镜像 tag: v4.8.15 Sandbox 镜像，可以不更新 运行升级脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4815&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会重置应用定时执行的字段，把 null 去掉，减少索引大小。
从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成fastgpt-pro域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/init/refreshFreeUser&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 重新计算一次免费版用户的时长，之前有版本升级时没有重新计算时间，导致会误发通知。</description></item><item><title>V4.8.14</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4814/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4814/</guid><description>更新指南 link1. 做好数据备份 link2. 修改镜像 link 更新 FastGPT 镜像 tag: v4.8.14-fix 更新 FastGPT 商业版镜像 tag: v4.8.14 （fastgpt-pro镜像） Sandbox 镜像，可以不更新 milvus版本使用：v4.8.14-milvus-fix 镜像。
新功能预览 link自动触发工作流 link可以允许你配置用户加载对话时，自动触发一次工作流。可以用于一些 CRM 系统，可以快速的引导用户使用，无需等待用户主动触发。
完整更新内容 link 新增 - 工作流支持进入聊天框/点击开始对话后，自动触发一轮对话。 新增 - 重写 chatContext，对话测试也会有日志，并且刷新后不会丢失对话。 新增 - 分享链接支持配置是否允许查看原文。 新增 - 新的 doc2x 插件。 新增 - 繁体中文。 新增 - 分析链接和 chat api 支持传入自定义 uid。 商业版新增 - 微软 oauth 登录 优化 - 工作流 ui 细节。 优化 - 应用编辑记录采用 diff 存储，避免浏览器溢出。 优化 - 代码入口，增加 register 入口，无需等待首次访问才执行。 优化 - 工作流检查，增加更多缺失值检查。 优化 - 增加知识库训练最大重试次数限制。 优化 - 图片路径问题和示意图任务 优化 - Milvus description 修复 - 分块策略，四级标题会被丢失。 同时新增了五级标题的支持。 修复 - MongoDB 知识库集合唯一索引。 修复 - 反选知识库引用后可能会报错。 修复 - 简易模式转工作流，不是使用最新编辑记录进行转移。 修复 - 表单输入的说明文字不显示。 修复 - API 无法使用 base64 图片。</description></item><item><title>V4.8.13</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4813/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4813/</guid><description>更新指南 link1. 做好数据备份 link2. 修改镜像 link 更新 FastGPT 镜像 tag: v4.8.13-fix 更新 FastGPT 商业版镜像 tag: v4.8.13-fix （fastgpt-pro镜像） Sandbox 镜像，可以不更新 3. 添加环境变量 link 给 fastgpt 和 fastgpt-pro 镜像添加环境变量：FE_DOMAIN=http://xx.com，值为 fastgpt 前端访问地址，注意后面不要加/。可以自动补齐相对文件地址的前缀。 4. 调整文件上传编排 link虽然依然兼容旧版的文件上传编排，但是未来两个版本内将会去除兼容代码，请尽快调整编排，以适应最新的文件上传逻辑。尤其是嵌套应用的文件传递，未来将不会自动传递，必须手动指定传递的文件。具体内容可参考: 文件上传变更
更新说明 link 新增 - 数组变量选择支持多选，可以选多个数组或对应的单一数据类型，会自动按选择顺序进行合并。 新增 - 文件上传方案调整，AI对话和工具调用节点直接支持接收文件链接，并且会强制加入提示词，无需由模型决策调用。插件自定义变量支持文件上传类型，取代全局文件。 新增 - 对话记录增加时间显示。 新增 - 工作流校验错误时，跳转至错误节点。 新增 - 循环节点增加下标值。 新增 - 部分对话错误提醒增加翻译。 新增 - 对话输入框支持拖拽文件上传，可直接拖文件到输入框中。 新增 - 对话日志，来源可显示分享链接/API具体名称 新增 - 分享链接支持配置是否展示实时运行状态。 优化 - 合并多个 system 提示词成 1 个，避免部分模型不支持多个 system 提示词。 优化 - 知识库上传文件，优化报错提示。 优化 - 全文检索语句，减少一轮子查询。 优化 - 修改 findLast 为 [&amp;hellip;array].</description></item><item><title>V4.8.12(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4812/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4812/</guid><description>更新指南 link1. 做好数据备份 link2. 修改镜像 link 更新 FastGPT 镜像 tag: v4.8.12-fix 更新 FastGPT 管理端镜像 tag: v4.8.12 （fastgpt-pro镜像） Sandbox 镜像，可以不更新 3. 商业版执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 管理端域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/init/4812&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会初始化应用和知识库的成员组数据。
4. 重构 Milvus 数据 link由于 js int64 精度丢失问题，之前私有化使用 milvus 或者 zilliz 的用户，如果存在数据精度丢失的问题，需要重构 Milvus 数据。（可以查看 dataset_datas 表中，indexes 中的 dataId 是否末尾精度丢失）。使用 PG 的用户不需要操作。
从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 主域名。</description></item><item><title>V4.8.11（商业版初始化）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4811/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4811/</guid><description>更新指南 link1. 做好数据备份 link2. 修改配置文件 link如需增加 openai o1 模型，可添加如下配置：
{ &amp;#34;model&amp;#34;: &amp;#34;o1-mini&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;o1-mini&amp;#34;, &amp;#34;avatar&amp;#34;: &amp;#34;/imgs/model/openai.svg&amp;#34;, &amp;#34;maxContext&amp;#34;: 125000, &amp;#34;maxResponse&amp;#34;: 65000, &amp;#34;quoteMaxToken&amp;#34;: 120000, &amp;#34;maxTemperature&amp;#34;: 1.2, &amp;#34;charsPointsPrice&amp;#34;: 0, &amp;#34;censor&amp;#34;: false, &amp;#34;vision&amp;#34;: false, &amp;#34;datasetProcess&amp;#34;: true, &amp;#34;usedInClassify&amp;#34;: true, &amp;#34;usedInExtractFields&amp;#34;: true, &amp;#34;usedInToolCall&amp;#34;: true, &amp;#34;toolChoice&amp;#34;: false, &amp;#34;functionCall&amp;#34;: false, &amp;#34;customCQPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;customExtractPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;defaultSystemChatPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;defaultConfig&amp;#34;: { &amp;#34;temperature&amp;#34;: 1 } }, { &amp;#34;model&amp;#34;: &amp;#34;o1-preview&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;o1-preview&amp;#34;, &amp;#34;avatar&amp;#34;: &amp;#34;/imgs/model/openai.svg&amp;#34;, &amp;#34;maxContext&amp;#34;: 125000, &amp;#34;maxResponse&amp;#34;: 32000, &amp;#34;quoteMaxToken&amp;#34;: 120000, &amp;#34;maxTemperature&amp;#34;: 1.2, &amp;#34;charsPointsPrice&amp;#34;: 0, &amp;#34;censor&amp;#34;: false, &amp;#34;vision&amp;#34;: false, &amp;#34;datasetProcess&amp;#34;: true, &amp;#34;usedInClassify&amp;#34;: true, &amp;#34;usedInExtractFields&amp;#34;: true, &amp;#34;usedInToolCall&amp;#34;: true, &amp;#34;toolChoice&amp;#34;: false, &amp;#34;functionCall&amp;#34;: false, &amp;#34;customCQPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;customExtractPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;defaultSystemChatPrompt&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;defaultConfig&amp;#34;: { &amp;#34;temperature&amp;#34;: 1 } } 3.</description></item><item><title>V4.8.10(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/4810/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/4810/</guid><description>更新指南 link1. 做好数据备份 link2. 商业版 —— 修改环境变量 link 需要给fastgpt-pro镜像，增加沙盒的环境变量：SANDBOX_URL=http://xxxxx:3000 给fastgpt-pro镜像和fastgpt镜像增加环境变量，以便更好的存储系统日志： LOG_LEVEL=debug STORE_LOG_LEVEL=warn 3. 修改镜像tag link 更新 FastGPT 镜像 tag: v4.8.10 更新 FastGPT 商业版镜像 tag: v4.8.10 Sandbox 镜像，可以不更新 4. 执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv4810&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化发布记录版本标记 初始化开票记录 V4.8.10 更新说明 link完整内容请见：4.8.10 release
新增 - 模板市场。 新增 - 工作流节点拖动自动对齐吸附。 新增 - 用户选择节点（Debug 模式暂未支持）。 新增 - 工作流增加 uid 全局变量。 新增 - 工作流撤销和重做。 新增 - 工作流本次编辑记录，取代自动保存。 新增 - 工作流版本支持重命名。 新增 - 工作流的“应用调用”节点弃用，迁移成单独节点，与插件使用方式相同，同时可以传递全局变量和用户上传的文件。 新增 - 插件增加使用说明配置。 新增 - 插件自定义输入支持单选框。 新增 - HTTP 节点支持 text/plain 模式。 新增 - HTTP模块支持超时配置、支持更多的 Body 类型，params 和 headers 支持新的变量选择模式。 新增 - 工作流导出导入，支持直接导出和导入 JSON 文件，便于交流。 新增 - 发送验证码安全校验。 商业版新增 - 飞书机器人接入。 商业版新增 - 公众号接入接入。 商业版新增 - 自助开票申请。 商业版新增 - SSO 定制。 优化 - 工作流循环校验，避免 skip 循环空转。同时支持分支完全并发执行。 优化 - 工作流嵌套执行，参数可能存在的污染问题。 优化 - 部分全局变量，增加数据类型约束。 优化 - 节点选择，避免切换 tab 时候，path 加载报错。 优化 - 最新 React Markdown 组件，支持 Base64 图片。 优化 - 对话框性能问题。 优化 - 单选框打开后自动滚动到选中的位置。 优化 - 知识库集合禁用，目录禁用会递归修改其下所有 children 的禁用状态。 优化 - SSE 响应代码优化。 优化 - 无 SSL 证书情况下，优化复制。 优化 - 知识库列表 UI。 优化 - 知识库详情页 UI。 优化 - 支持无网络配置情况下运行。 优化 - 调整.</description></item><item><title>V4.8.9（需要初始化）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/489/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/489/</guid><description>升级指南 link1. 做好数据库备份 link2. 修改镜像 link 更新 FastGPT 镜像 tag: v4.8.9 更新 FastGPT 商业版镜像 tag: v4.8.9 Sandbox 镜像，可以不更新 3. 商业版执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 商业版域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/init/489&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会初始化多租户的通知方式，仅内部使用的，无需执行。
V4.8.9 更新说明 link 新增 - 文件上传配置，不再依赖视觉模型决定是否可上传图片，而是通过系统配置决定。 新增 - AI 对话节点和工具调用支持选择“是否开启图片识别”，开启后会自动获取对话框上传的图片和“用户问题”中的图片链接。 新增 - 文档解析节点。 商业版新增 - 团队通知账号绑定，用于接收重要信息。 商业版新增 - 知识库集合标签功能，可以对知识库进行标签管理。 商业版新增 - 知识库搜索节点支持标签过滤和创建时间过滤。 商业版新增 - 转移 App owner 权限。 新增 - 删除所有对话引导内容。 新增 - QA 拆分支持自定义 chunk 大小，并优化 gpt4o-mini 拆分时，chunk 太大导致生成内容很少的问题。 优化 - 对话框信息懒加载，减少网络传输。 优化 - 清除选文件缓存，支持重复选择同一个文件。 修复 - 知识库上传文件，网络不稳定或文件较多情况下，进度无法到 100%。 修复 - 删除应用后回到聊天选择最后一次对话的应用为删除的应用时提示无该应用问题。 修复 - 插件动态变量配置默认值时，无法正常显示默认值。 修复 - 工具调用温度和最大回复值未生效。 修复 - 函数调用模式，assistant role 中，GPT 模型必须传入 content 参数。（不影响大部分模型，目前基本都改用用 ToolChoice 模式，FC 模式已弃用）。 修复 - 知识库文件上传进度更新可能异常。 修复 - 知识库 rebuilding 时候，页面总是刷新到第一页。 修复 - 知识库 list openapi 鉴权问题。 修复 - 分享链接，新对话无法反馈。</description></item><item><title>V4.8.8(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/488/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/488/</guid><description>升级指南 link1. 做好数据库备份 link2. 修改镜像 link fastgpt 镜像 tag 修改成 v4.8.8-fix2 商业版镜像 tag 修改成 v4.8.8 3. 执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv488&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会初始化知识库的继承权限
V4.8.8 更新说明 link点击查看完整更新
新增 - 重构系统插件的结构。允许向开源社区 PR 系统插件，具体可见: 如何向 FastGPT 社区提交系统插件。 新增 - DuckDuckGo 系统插件。 新增 - 飞书 webhook 系统插件。 新增 - 修改变量填写方式。提示词输入框以以及工作流中所有 Textarea 输入框，支持输入 / 唤起变量选择，可直接选择所有上游输出值，无需动态引入。 商业版新增 - 知识库权限继承。 优化 - 移动端快速切换应用交互。 优化 - 节点图标。 优化 - 对话框引用增加额外复制案件，便于复制。增加引用内容折叠。 优化 - OpenAI sdk 升级，并自定义了 whisper 模型接口（未仔细查看 sdk 实现，但 sdk 中 whisper 接口，似乎无法适配一般 fastapi 接口） 修复 - Permission 表声明问题。 修复 - 并行执行节点，运行时间未正确记录。 修复 - 运行详情未正确展示嵌套节点信息。 修复 - 简易模式，首次进入，无法正确获取知识库配置。 修复 - Log debug level 配置无效。 修复 - 插件独立运行时，会将插件输入的值进行变量替换，可能导致后续节点变量异常。</description></item><item><title>V4.8.7</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/487/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/487/</guid><description>升级指南 link1. 做好数据库备份 link2. 修改镜像 link fastgpt 镜像 tag 修改成 v4.8.7 商业版镜像 tag 修改成 v4.8.7 V4.8.7 更新说明 link 新增 - 插件支持独立运行，发布和日志查看 新增 - 应用搜索 优化 - 对话框代码 优化 - 升级 Dockerfile node 和 pnpm 版本 优化 - local 域名部署，也可以正常使用 vision 模式 修复 - 简易模式无法变更全局变量 修复 - gpt4o 无法同时使用工具和图片</description></item><item><title>V4.8.6(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/486/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/486/</guid><description>升级指南 link1. 做好数据库备份 link2. 修改镜像 link fastgpt 镜像 tag 修改成 v4.8.6 fastgpt-sandbox 镜像 tag 修改成 v4.8.6 商业版镜像 tag 修改成 v4.8.6 3. 执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv486&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会初始化应用的继承权限
V4.8.6 更新说明 link 新增 - 应用权限继承 新增 - 知识库支持单个集合禁用功能 新增 - 系统插件模式变更，新增链接读取和数学计算器插件，正式版会更新如何自定义系统插件 新增 - 代码沙盒运行参数 新增 - AI对话时隐藏头部的功能，主要是适配移动端 优化 - 文件读取，Mongo 默认使用从节点，减轻主节点压力 优化 - 提示词模板 优化 - Mongo model 重复加载 修复 - 创建链接集合未返回 id 修复 - 文档接口说明 修复 - api system 提示合并 修复 - 团队插件目录内的内容无法加载 修复 - 知识库集合目录面包屑无法加载 修复 - Markdown 导出对话异常 修复 - 提示模板结束标签错误 修复 - 文档描述</description></item><item><title>V4.8.5(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/485/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/485/</guid><description>升级指南 link1. 做好数据库备份 link2. 修改镜像 link fastgpt 镜像 tag 修改成 v4.8.5 商业版镜像 tag 修改成 v4.8.5 3. 执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv485&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会把插件的数据表合并到应用中，插件表不会删除。
商业版用户执行额外的初始化
从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 商业版的域名：
curl --location --request POST &amp;#39;https://{{host}}/api/admin/init/485&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会重置知识库权限系统。
V4.8.5 更新说明 link 新增 - 合并插件和应用，统一成工作台 新增 - 应用创建副本功能 新增 - 应用创建模板 新增 - 支持代码运行结果作为工具输出。 新增 - Markdown 图片输出，支持移动端放大缩放。 优化 - 原文件编码存取 优化 - 知识库删除后，简易模式会过滤掉删除的知识库，避免错误判断。 优化 - 文件夹读取，支持单个文件夹超出 100 个文件 优化 - 问答拆分/手动录入，当有a字段时，自动将q作为补充索引。 优化 - 对话框页面代码 优化 - 工作流新节点自动增加序号名 修复 - 定时任务无法实际关闭 修复 - 输入引导特殊字符导致正则报错 修复 - 文件包含特殊字符%，且为转义时会导致页面崩溃 修复 - 自定义输入选择知识库引用时页面崩溃</description></item><item><title>V4.8.4(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/484/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/484/</guid><description>升级指南 link1. 修改镜像 link fastgpt 镜像 tag 修改成 v4.8.4 fastgpt-sandbox 镜像 tag 修改成 v4.8.4 (选择性，无变更) 商业版镜像 tag 修改成 v4.8.4 2. 商业版用户执行初始化 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT 商业版的域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/init/484&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; V4.8.4 更新说明 link 新增 - 应用使用新权限系统。 新增 - 应用支持文件夹。 优化 - 文本分割增加连续换行、制表符清除，避免大文本性能问题。 重要修复 - 修复系统插件运行池数据污染问题，由于从内存获取，会导致全局污染。 修复 - Debug 模式下，相同 source 和 target 内容，导致连线显示异常。 修复 - 定时执行初始化错误。 修复 - 应用调用传参异常。 修复 - ctrl + cv 复杂节点时，nodeId错误。 调整组件库全局theme。</description></item><item><title>V4.8.3</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/483/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/483/</guid><description>升级指南 link fastgpt 镜像 tag 修改成 v4.8.3 fastgpt-sandbox 镜像 tag 修改成 v4.8.3 商业版镜像 tag 修改成 v4.8.3 V4.8.3 更新说明 link 新增 - 支持 Milvus 数据库， 可参考最新的 docker-compose-milvus.yml. 新增 - 给 chat 接口 empty answer 增加 log，便于排查模型问题。 新增 - ifelse判断器，字符串支持正则。 新增 - 代码运行支持 console.log 输出调试。 修复 - 变量更新在 Debug 模式下出错。</description></item><item><title>V4.8.2</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/482/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/482/</guid><description>Sealos 升级说明 link 在应用管理中新建一个应用，镜像为：registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt-sandbox:v4.8.1 无需外网访问地址，端口号为3000 部署完后，复制应用的内网地址 点击变更`FastGPT - 修改环境变量，增加下面的环境变量即可 SANDBOX_URL=内网地址 Docker 部署 link可以拉取最新 docker-compose.yml 文件参考
新增一个容器 sandbox fastgpt 和 fastgpt-pro(商业版) 容器新增环境变量: SANDBOX_URL sandbox 简易不要开启外网访问，未做凭证校验。 V4.8.2 更新说明 link 新增 - js代码运行节点（更完整的type提醒，后续继续完善） 新增 - 内容提取节点支持数据类型选择 修复 - 新增的站点同步无法使用 修复 - 定时任务无法输入内容</description></item><item><title>V4.8.1(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/481/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/481/</guid><description>初始化脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT的域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv481&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 由于之前集合名不规范，该初始化会重置表名。请在初始化前，确保 dataset.trainings 表没有数据。 最好更新该版本时，暂停所有进行中业务，再进行初始化，避免数据冲突。
执行脏数据清理 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT的域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/clearInvalidData&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化完后，可以执行这个命令。之前定时清理的定时器有些问题，部分数据没被清理，可以手动执行清理。
V4.8.1 更新说明 link使用 Chat api 接口需要注意，增加了 event: updateVariables 事件，用于更新变量。
点击查看升级说明</description></item><item><title>V4.8</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/48/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/48/</guid><description>新工作流 linkFastGPT workflow V2上线，支持更加简洁的工作流模式。
🤖
由于工作流差异较大，不少地方需要手动重新构建。请依次重建插件和应用
简易尽快更新工作流，避免未来持续迭代后导致无法兼容。
给应用和插件增加了 version 的字段，用于标识是旧工作流还是新工作流。当你更新 4.8 后，保存和新建的工作流均为新版，旧版工作流会有一个重置的弹窗提示。并且，如果是通过 API 和 分享链接 调用的工作流，仍可以正常使用，直到你下次保存它们。
商业版配置更新 link商业版用户如果配置了邮件验证码，需要在管理端 -&amp;gt; 项目配置 -&amp;gt; 登录配置 -&amp;gt; 邮箱登录配置 -&amp;gt; 修改 邮箱服务SMTP地址，之前只能配置别名，现在可以配置自定义的地址。下面是一组别名和实际地址关系：
qq: smtp.qq.com gmail: smtp.gmail.com
V4.8 更新说明 link 重构 - 工作流 新增 - 判断器。支持 if elseIf else 判断。 @newfish-cmyk （preview版本的if else节点需要删除重建） 新增 - 变量更新节点。支持更新运行中工作流输出变量，或更新全局变量。@newfish-cmyk 新增 - 工作流自动保存和版本管理。 新增 - 工作流 Debug 模式，可以调试单个节点或者逐步调试工作流。 新增 - 定时执行应用。可轻松实现定时任务。 新增 - 插件自定义输入优化，可以渲染输入组件。 新增 - 分享链接发送对话前 hook https://github.com/labring/FastGPT/pull/1252 @gaord 优化 - 工作流连线，可以四向连接，方便构建循环工作流。 优化 - 工作流上下文传递，性能🚀。 优化 - ctrl和alt+enter换行，换行符位置不正确。 优化 - chat中存储变量配置。避免修改变量后，影响旧的对话。 优化 - 简易模式，更新配置后自动更新调试框内容，无需保存。 优化 - worker进程管理，并将计算 Token 任务分配给 worker 进程。 优化 - 工具调用支持指定字段数据类型（string, boolean, number） https://github.</description></item><item><title>V4.7.1(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/471/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/471/</guid><description>初始化脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成FastGPT的域名。
curl --location --request POST &amp;#39;https://{{host}}/api/admin/clearInvalidData&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 该请求会执行脏数据清理（清理无效的文件、清理无效的图片、清理无效的知识库集合、清理无效的向量）
修改配置文件 link增加了Laf环境配置：点击查看最新的配置文件
V4.7.1 更新说明 link 新增 - 语音输入完整配置。支持选择是否打开语音输入（包括分享页面），支持语音输入后自动发送，支持语音输入后自动语音播放（流式）。 新增 - pptx 和 xlsx 文件读取。但所有文件读取都放服务端，会消耗更多的服务器资源，以及无法在上传时预览更多内容。 新增 - 集成 Laf 云函数，可以读取 Laf 账号中的云函数作为 HTTP 模块。 新增 - 定时器，清理垃圾数据。（采用小范围清理，会清理最近n个小时的，所以请保证服务持续运行，长时间不允许，可以继续执行 clearInvalidData 的接口进行全量清理。） 商业版新增 - 后台配置系统通知。 优化 - 支持ip模式导出知识库。 修改 - csv导入模板，取消 header 校验，自动获取前两列。 修复 - 工具调用模块连线数据类型校验错误。 修复 - 自定义索引输入时，解构数据失败。 修复 - rerank 模型数据格式。 修复 - 问题补全历史记录BUG 修复 - 分享页面特殊情况下加载缓慢问题（由于ssr时候数据库不会触发连接）</description></item><item><title>V4.7（需要初始化）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/47/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/47/</guid><description>1. 修改配置文件 link增加一些 Boolean 值，用于决定不同功能块可以使用哪些模型，同时增加了模型的 logo：点击查看最新的配置文件
2. 初始化脚本 link升级完镜像后。从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成自己域名
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv47&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 脚本功能：
初始化插件的 parentId 3. 升级 ReRank 模型 link4.7对ReRank模型进行了格式变动，兼容 cohere 的格式，可以直接使用 cohere 提供的 API。如果是本地的 ReRank 模型，需要修改镜像为：registry.cn-hangzhou.aliyuncs.com/fastgpt/bge-rerank-base:v0.1 。
cohere的重排模型对中文不是很好，感觉不如 bge 的好用，接入教程如下：
申请 Cohere 官方 Key: https://dashboard.cohere.com/api-keys 修改 FastGPT 配置文件 { &amp;#34;reRankModels&amp;#34;: [ { &amp;#34;model&amp;#34;: &amp;#34;rerank-multilingual-v2.0&amp;#34;, // 这里的 model 需要对应 cohere 的模型名 &amp;#34;name&amp;#34;: &amp;#34;检索重排&amp;#34;, // 随意 &amp;#34;requestUrl&amp;#34;: &amp;#34;https://api.</description></item><item><title>V4.6.9(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/469/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/469/</guid><description>修改商业版环境变量 link增加 oneapi 地址和令牌。
OPENAI_BASE_URL=http://oneapi:3000/v1 CHAT_API_KEY=sk-fastgpt 初始化脚本 link从任意终端，发起 1 个 HTTP 请求。其中 {{rootkey}} 替换成环境变量里的 rootkey；{{host}} 替换成自己域名
curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv469&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 重置计量表。 执行脏数据清理（清理无效的文件、清理无效的图片、清理无效的知识库集合、清理无效的向量） 外部接口更新 link 由于计费系统变更，分享链接对话上报接口需要做一些调整，price字段被totalPoints字段取代。inputToken和outputToken不再提供，只提供token字段（总token数量）。 V4.6.9 更新说明 link 商业版新增 - 知识库新增“增强处理”训练模式，可生成更多类型索引。 新增 - 完善了HTTP模块的变量提示。 新增 - HTTP模块支持OpenAI单接口导入。 新增 - 全局变量支持增加外部变量。可通过分享链接的Query或 API 的 variables 参数传入。 新增 - 内容提取模块增加默认值。 优化 - 问题补全。增加英文类型。同时可以设置为单独模块，方便复用。 优化 - 重写了计量模式 优化 - Token 过滤历史记录，保持偶数条，防止部分模型报错。 优化 - 分享链接SEO，可直接展示应用名和头像。 修复 - 标注功能。 修复 - qa生成线程计数错误。 修复 - 问题分类连线类型错误</description></item><item><title>V4.6.8（需要初始化）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/468/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/468/</guid><description>docker 部署 - 手动更新 Mongo link 修改 docker-compose.yml 的mongo部分，补上command和entrypoint mongo: image: mongo:5.0.18 # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18 # 阿里云 container_name: mongo ports: - 27017:27017 networks: - fastgpt command: mongod --keyFile /data/mongodb.key --replSet rs0 environment: # 这里密码注意要和以前的一致 - MONGO_INITDB_ROOT_USERNAME=username - MONGO_INITDB_ROOT_PASSWORD=password volumes: - ./mongo/data:/data/db entrypoint: - bash - -c - | openssl rand -base64 128 &amp;gt; /data/mongodb.key chmod 400 /data/mongodb.key chown 999:999 /data/mongodb.key echo &amp;#39;const isInited = rs.status().ok === 1 if(!isInited){ rs.initiate({ _id: &amp;#34;rs0&amp;#34;, members: [ { _id: 0, host: &amp;#34;mongo:27017&amp;#34; } ] }) }&amp;#39; &amp;gt; /data/initReplicaSet.</description></item><item><title>V4.6.7（需要初始化）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/467/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/467/</guid><description>1。执行初始化 API link发起 1 个 HTTP 请求 ({{rootkey}} 替换成环境变量里的 rootkey，{{host}} 替换成自己域名)
https://xxxxx/api/admin/initv467 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv467&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化说明：
将 images 重新关联到数据集 设置 pg 表的 null 值。 V4.6.7 更新说明 link 修改了知识库UI及新的导入交互方式。 优化知识库和对话的数据索引。 知识库 openAPI，支持通过 API 操作知识库。 新增 - 输入框变量提示。输入 { 号后将会获得可用变量提示。根据社区针对高级编排的反馈，我们计划于 2 月份的版本中，优化变量内容，支持模块的局部变量以及更多全局变量写入。 优化 - 切换团队后会保存记录，下次登录时优先登录该团队。 修复 - API 对话时，chatId 冲突问题。 修复 - Iframe 嵌入网页可能导致的 window.onLoad 冲突。</description></item><item><title>V4.6.6（需要改配置文件）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/466/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/466/</guid><description>配置文件变更 link为了减少代码重复度，我们对配置文件做了一些修改：点击查看最新的配置文件
商业版变更 link 更新商业版镜像到 4.6.6 版本。
将旧版配置文件中的 SystemParams.pluginBaseUrl 放置到环境变量中:
PRO_URL=商业版镜像地址（此处不再需要以 /api 结尾），例如:
PRO_URL=http://fastgpt-plugin.ns-hsss5d.svc.cluster.local:3000
原本在配置文件中的 FeConfig 已被移除，可以直接打开新的商业版镜像外网地址进行配置。包括 FastGPT 的各个参数和模型都可以直接在商业版镜像中配置，无需再变更 config.json 文件。
V4.6.6 更新说明 link 查看 FastGPT 2024 RoadMap 新增 - Http 模块请求头支持 Json 编辑器。 新增 - ReRank模型部署 新增 - 搜索方式：分离向量语义检索，全文检索和重排，通过 RRF 进行排序合并。 优化 - 问题分类提示词，id引导。测试国产商用 api 模型（百度阿里智谱讯飞）使用 Prompt 模式均可分类。 UI 优化，未来将逐步替换新的UI设计。 优化代码：Icon 抽离和自动化获取。 修复 - 链接读取的数据集，未保存选择器，导致同步时不使用选择器。</description></item><item><title>V4.6.5（需要改配置文件）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/465/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/465/</guid><description>配置文件变更 link由于 openai 已开始弃用 function call，改为 toolChoice。FastGPT 同步的修改了对于的配置和调用方式，需要对配置文件做一些修改：
点击查看最新的配置文件
主要是修改模型的functionCall字段，改成toolChoice即可。设置为true的模型，会默认走 openai 的 tools 模式；未设置或设置为false的，会走提示词生成模式。 问题优化模型与内容提取模型使用同一组配置。
增加 &amp;quot;ReRankModels&amp;quot;: [] V4.6.5 功能介绍 link 新增 - 问题优化模块 新增 - 文本编辑模块 新增 - 判断器模块 新增 - 自定义反馈模块 新增 - 【内容提取】模块支持选择模型，以及字段枚举 优化 - docx读取，兼容表格（表格转markdown） 优化 - 高级编排连接线交互 优化 - 由于 html2md 导致的 cpu密集计算，阻断线程问题 修复 - 高级编排提示词提取描述</description></item><item><title>V4.6.4(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/464/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/464/</guid><description>1。执行初始化 API link发起 1 个 HTTP 请求 ({{rootkey}} 替换成环境变量里的 rootkey，{{host}} 替换成自己域名)
https://xxxxx/api/admin/initv464 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv464&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化说明：
初始化 PG 的createTime字段 初始化 Mongo 中 chat 的 feedback 字段 V4.6.4 功能介绍 link 重写 - 分享链接身份逻辑，采用 localID 记录用户的ID。 商业版新增 - 分享链接 SSO 方案，通过身份鉴权地址，仅需3个接口即可完全接入已有用户系统。具体参考分享链接身份鉴权 新增 - 分享链接更多嵌入方式提示，更多DIY方式。 优化 - 历史记录模块。弃用旧的历史记录模块，直接在对应地方填写数值即可。 调整 - 知识库搜索模块 topk 逻辑，采用 MaxToken 计算，兼容不同长度的文本块 调整鉴权顺序，提高 apikey 的优先级，避免cookie抢占 apikey 的鉴权。 链接读取支持多选择器。参考Web 站点同步用法 修复 - 分享链接图片上传鉴权问题 修复 - Mongo 连接池未释放问题。 修复 - Dataset Intro 无法更新 修复 - md 代码块问题 修复 - root 权限问题 优化 docker file</description></item><item><title>V4.6.3(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/463/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/463/</guid><description>1。执行初始化 API link发起 1 个 HTTP 请求 ({{rootkey}} 替换成环境变量里的 rootkey，{{host}} 替换成自己域名)
https://xxxxx/api/admin/initv463 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv463&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化说明：
初始化Mongo 中 dataset，collection 和 data 的部分字段 V4.6.3 功能介绍 link 商业版新增 - web站点同步 新增 - 集合元数据记录 优化 - url 读取内容 优化 - 流读取文件，防止内存溢出 优化 - 4v模型自动将 url 转 base64，本地也可调试 优化 - 图片压缩等级 修复 - 图片压缩失败报错，防止文件读取过程卡死。</description></item><item><title>V4.6.2(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/462/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/462/</guid><description>1。执行初始化 API link发起 1 个 HTTP 请求 ({{rootkey}} 替换成环境变量里的 rootkey，{{host}} 替换成自己域名)
https://xxxxx/api/admin/initv462 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv462&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化说明：
初始化全文索引 V4.6.2 功能介绍 link 新增 - 全文索引（需配合 Rerank 模型，在看怎么放到开源版，模型接口比较特殊） 新增 - 插件来源（预计4.7/4.8版本会正式使用） 优化 - PDF读取 优化 - docx文件读取，转成 markdown 并保留其图片内容 修复和优化 TextSplitter 函数</description></item><item><title>V4.6.1</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/461/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/461/</guid><description>V4.6.1 功能介绍 link 新增 - GPT4-v 模型支持 新增 - whisper 语音输入 优化 - TTS 流传输 优化 - TTS 缓存</description></item><item><title>V4.6(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/46/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/46/</guid><description>V4.6 版本加入了简单的团队功能，可以邀请其他用户进来管理资源。该版本升级后无法执行旧的升级脚本，且无法回退。
1。更新镜像并变更配置文件 link更新镜像至 latest 或者 v4.6 版本。商业版镜像更新至 V0.2.1
最新配置可参考：V46 版本最新 config.json，商业镜像配置文件也更新，参考最新的飞书文档。
2。执行初始化 API link发起 2 个 HTTP 请求 ({{rootkey}} 替换成环境变量里的 rootkey，{{host}} 替换成自己域名)
该初始化接口可能速度很慢，返回超时不用管，注意看日志即可，需要注意的是，需确保 initv46 成功后，在执行 initv46-2
https://xxxxx/api/admin/initv46 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv46&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; https://xxxxx/api/admin/initv46-2 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv46-2&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化内容： 1。创建默认团队 2。初始化 Mongo 所有资源的团队字段 3。初始化 Pg 的字段 4。初始化 Mongo Data
V4.6 功能介绍 link 新增 - 团队空间 新增 - 多路向量 (多个向量映射一组数据) 新增 - tts 语音 新增 - 支持知识库配置文本预处理模型 线上环境新增 - ReRank 向量召回，提高召回精度 优化 - 知识库导出，可直接触发流下载，无需等待转圈圈 4.</description></item><item><title>V4.5.2</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/452/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/452/</guid><description>功能介绍 linkFast GPT V4.5.2 link 新增 - 模块插件，允许自行组装插件进行模块复用。 优化 - 知识库引用提示。</description></item><item><title>V4.5.1(需进行初始化)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/451/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/451/</guid><description>执行初始化 API link发起 1 个 HTTP 请求（{{rootkey}} 替换成环境变量里的rootkey，{{host}}替换成自己域名）
https://xxxxx/api/admin/initv451 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv451&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化内容：
rename 数据库字段 初始化 Mongo APP 表中知识库的相关字段 初始化 PG 和 Mongo 的内容，为每个文件创建一个集合（存储 Mongo 中），并反馈赋值给 PG。 该初始化接口可能速度很慢，返回超时不用管，注意看日志即可
功能介绍 linkFast GPT V4.5.1 link 新增知识库文件夹管理 修复了 openai4.x sdk 无法兼容 oneapi 的智谱和阿里的接口。 修复部分模块无法触发完成事件</description></item><item><title>V4.5(需进行较为复杂更新)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/45/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/45/</guid><description>FastGPT V4.5 引入 PgVector0.5 版本的 HNSW 索引，极大的提高了知识库检索的速度，比起IVFFlat索引大致有3~10倍的性能提升，可轻松实现百万数据毫秒级搜索。缺点在于构建索引的速度非常慢，4c16g 500w 组数据使用并行构建大约花了 48 小时。具体参数配置可参考 PgVector官方
下面需要对数据库进行一些操作升级：
PgVector升级：Sealos 部署方案 link 点击Sealos桌面的数据库应用。 点击【pg】数据库的详情。 点击右上角的重启，等待重启完成。 点击左侧的一键链接，等待打开 Terminal。 依次输入下方 sql 命令 -- 升级插件名 ALTER EXTENSION vector UPDATE; -- 插件是否升级成功，成功的话，vector插件版本为 0.5.0，旧版的为 0.4.1 \dx -- 下面两个语句会设置 pg 在构建索引时可用的内存大小，需根据自身的数据库规格来动态配置，可配置为 1/4 的内存大小 alter system set maintenance_work_mem = &amp;#39;2400MB&amp;#39;; select pg_reload_conf(); -- 重构数据库索引和排序 REINDEX DATABASE postgres; -- 开始构建索引，该索引构建时间非常久，直接点击右上角的叉，退出 Terminal 即可 CREATE INDEX CONCURRENTLY vector_index ON modeldata USING hnsw (vector vector_ip_ops) WITH (m = 16, ef_construction = 64); -- 可以再次点击一键链接，进入 Terminal，输入下方命令，如果看到 &amp;#34;vector_index&amp;#34; hnsw (vector vector_ip_ops) WITH (m=&amp;#39;16&amp;#39;, ef_construction=&amp;#39;64&amp;#39;) 则代表构建完成（注意，后面没有 INVALID） \d modeldata PgVector升级：Docker-compose.</description></item><item><title>V4.4.7（需执行升级脚本）</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/447/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/447/</guid><description>执行初始化 API link发起 1 个 HTTP 请求（{{rootkey}} 替换成环境变量里的rootkey，{{host}}替换成自己域名）
https://xxxxx/api/admin/initv447 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv447&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化 pg 索引以及将 file_id 中空对象转成 manual 对象。如果数据多，可能需要较长时间，可以通过日志查看进度。
功能介绍 linkFast GPT V4.4.7 link 优化了数据库文件 crud。 兼容链接读取，作为 source。 区分手动录入和标注，可追数据至某个文件。 升级 openai sdk。</description></item><item><title>V4.4.6</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/446/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/446/</guid><description>功能介绍 link 高级编排新增模块 - 应用调用，可调用其他应用。 新增 - 必要连接校验 修复 - 下一步指引在免登录中身份问题。</description></item><item><title>V4.4.5(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/445/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/445/</guid><description>执行初始化 API link发起 1 个 HTTP 请求（记得携带 headers.rootkey，这个值是环境变量里的）
https://xxxxx/api/admin/initv445 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv445&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 初始化了 variable 模块，将其合并到用户引导模块中。
功能介绍 linkFast GPT V4.4.5 link 新增 - 下一步指引选项，可以通过模型生成 3 个预测问题。 商业版新增 - 分享链接限制及 hook 身份校验（可对接已有的用户系统）。 商业版新增 - Api Key 使用。增加别名、额度限制和过期时间。自带 appId，无需额外连接。 优化 - 全局变量与开场白合并成同一模块。</description></item><item><title>升级到 V4.4.2(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/442/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/442/</guid><description>执行初始化 API link发起 1 个 HTTP 请求 (记得携带 headers.rootkey，这个值是环境变量里的)
https://xxxxx/api/admin/initv442 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv442&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会给初始化 Mongo 的 Bill 表的索引，之前过期时间有误。</description></item><item><title>升级到 V4.4.1(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/441/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/441/</guid><description>执行初始化 API link发起 1 个 HTTP 请求（记得携带 headers.rootkey，这个值是环境变量里的）
https://xxxxx/api/admin/initv441 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv441&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会给初始化 Mongo 的 dataset.files，将所有数据设置为可用。</description></item><item><title>升级到 V4.4(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/44/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/44/</guid><description>执行初始化 API link发起 1 个 HTTP 请求 (记得携带 headers.rootkey，这个值是环境变量里的)
https://xxxxx/api/admin/initv44 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv44&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会给初始化 Mongo 的部分字段。</description></item><item><title>升级到 V4.3(包含升级脚本)</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/43/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/43/</guid><description>执行初始化 API link发起 1 个 HTTP 请求 (记得携带 headers.rootkey，这个值是环境变量里的)
https://xxxxx/api/admin/initv43 curl --location --request POST &amp;#39;https://{{host}}/api/admin/initv43&amp;#39; \ --header &amp;#39;rootkey: {{rootkey}}&amp;#39; \ --header &amp;#39;Content-Type: application/json&amp;#39; 会给 PG 数据库的 modeldata 表插入一个新列 file_id，用于存储文件 ID。
增加环境变量 link增加一个 FILE_TOKEN_KEY 环境变量，用于生成文件预览链接，过期时间为 30 分钟。
FILE_TOKEN_KEY=filetokenkey</description></item><item><title>升级到 V4.2.1</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/421/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/421/</guid><description>私有部署，如果添加了配置文件，需要在配置文件中修改 VectorModels 字段。增加 defaultToken 和 maxToken，分别对应直接分段时的默认 token 数量和该模型支持的 token 上限 (通常不建议超过 3000)
&amp;#34;VectorModels&amp;#34;: [ { &amp;#34;model&amp;#34;: &amp;#34;text-embedding-ada-002&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;Embedding-2&amp;#34;, &amp;#34;price&amp;#34;: 0, &amp;#34;defaultToken&amp;#34;: 500, &amp;#34;maxToken&amp;#34;: 3000 } ] 改动目的是，我们认为不需要留有选择余地，选择一个最合适的模型去进行任务即可。</description></item><item><title>升级到 V4.2</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/42/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/42/</guid><description>99.9%用户不影响，升级 4.2 主要是修改了配置文件中 QAModel 的格式。从原先的数组改成对象：
&amp;#34;QAModel&amp;#34;: { &amp;#34;model&amp;#34;: &amp;#34;gpt-3.5-turbo-16k&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;GPT35-16k&amp;#34;, &amp;#34;maxToken&amp;#34;: 16000, &amp;#34;price&amp;#34;: 0 } 改动目的是，我们认为不需要留有选择余地，选择一个最合适的模型去进行任务即可。</description></item><item><title>升级到 V4.1</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/41/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/41/</guid><description>如果您是从旧版本升级到 V4.1，由于新版重新设置了对话存储结构，需要初始化原来的存储内容。
更新环境变量 linkV4.1 优化了 PostgreSQL 和 MongoDB 的连接变量，只需要填 1 个 URL 即可：
注意：/fastgpt 和 /postgres 是指数据库名称，需要和旧版的变量对应。
# mongo 配置，不需要改. 如果连不上，可能需要去掉 ?authSource=admin - MONGODB_URI=mongodb://username:password@mongo:27017/fastgpt?authSource=admin # pg配置. 不需要改 - PG_URL=postgresql://username:password@pg:5432/postgres 初始化 API link部署新版项目，并发起 1 个 HTTP 请求（记得携带 headers.rootkey，这个值是环境变量里的）
https://xxxxx/api/admin/initChatItem</description></item><item><title>升级到 V4.0</title><link>https://doc.tryfastgpt.ai/docs/development/upgrading/40/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://doc.tryfastgpt.ai/docs/development/upgrading/40/</guid><description>如果您是从旧版本升级到 V4，由于新版 MongoDB 表变更比较大，需要按照本文档的说明执行一些初始化脚本。
重命名表名 link需要连接上 MongoDB 数据库，执行两条命令：
db.models.renameCollection(&amp;#34;apps&amp;#34;) db.sharechats.renameCollection(&amp;#34;outlinks&amp;#34;) warning 注意：从旧版更新到 V4， MongoDB 会自动创建空表，你需要先手动删除这两个空表，再执行上面的操作。
初始化几个表中的字段 link依次执行下面 3 条命令，时间比较长，不成功可以重复执行（会跳过已经初始化的数据），直到所有数据更新完成。
db.chats.find({appId: {$exists: false}}).forEach(function(item){ db.chats.updateOne( { _id: item._id, }, { &amp;#34;$set&amp;#34;: {&amp;#34;appId&amp;#34;:item.modelId}} ) }) db.collections.find({appId: {$exists: false}}).forEach(function(item){ db.collections.updateOne( { _id: item._id, }, { &amp;#34;$set&amp;#34;: {&amp;#34;appId&amp;#34;:item.modelId}} ) }) db.outlinks.find({shareId: {$exists: false}}).forEach(function(item){ db.outlinks.updateOne( { _id: item._id, }, { &amp;#34;$set&amp;#34;: {&amp;#34;shareId&amp;#34;:item._id.toString(),&amp;#34;appId&amp;#34;:item.modelId}} ) }) 初始化 API link部署新版项目，并发起 3 个 HTTP 请求（记得携带 headers.rootkey，这个值是环境变量里的）
https://xxxxx/api/admin/initv4 https://xxxxx/api/admin/initChat https://xxxxx/api/admin/initOutlink 1 和 2 有可能会因为内存不足挂掉，可以重复执行。</description></item></channel></rss>